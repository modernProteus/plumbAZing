<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PlumbAZing | Your Aâ€“Z Plumbing Experts</title>
    <meta
      name="description"
      content="PlumbAZing â€” honest, reliable residential plumbing in Austin, TX. Call or text (512) 888-4406. Request service at plumbazing.com."
    />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://plumbazing.com/" />
    <meta
      property="og:title"
      content="PlumbAZing | Your Aâ€“Z Plumbing Experts"
    />
    <meta
      property="og:description"
      content="Honest, reliable residential plumbing in Austin. Call/text (512) 888-4406 or request service."
    />
    <meta
      property="og:image"
      content="https://plumbazing.com/img/PlumbAZing_logo.jpeg"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="PlumbAZing | Your Aâ€“Z Plumbing Experts"
    />
    <meta
      name="twitter:description"
      content="Honest, reliable residential plumbing in Austin. Call/text (512) 888-4406 or request service."
    />
    <meta
      name="twitter:image"
      content="https://plumbazing.com/img/PlumbAZing_logo.jpeg"
    />

    <link rel="icon" href="favicon-32.png" />
    <link rel="apple-touch-icon" href="apple-touch-icon.png" />

    <style>
      :root {
        --blue: #0b3d91;
        --red: #c1121f;
        --ink: #0f172a;
        --muted: #475569;
        --bg: #ffffff;
        --card: #f8fafc;
        --line: #e2e8f0;
        --shadow: 0 10px 30px rgba(2, 8, 23, 0.08);
        --radius: 18px;
        --max: 1120px;
      }

      * {
        box-sizing: border-box;
      }
      html {
        scroll-behavior: smooth;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
          Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--ink);
        background: var(--bg);
        line-height: 1.45;
      }
      a {
        color: inherit;
      }

      .container {
        max-width: var(--max);
        margin: 0 auto;
        padding: 0 18px;
      }

      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 12px 16px;
        border-radius: 999px;
        border: 1px solid transparent;
        text-decoration: none;
        font-weight: 800;
        letter-spacing: 0.2px;
        transition: transform 0.08s ease, box-shadow 0.15s ease,
          background 0.15s ease;
        white-space: nowrap;
        cursor: pointer;
      }
      .btn:active {
        transform: translateY(1px);
      }

      .btn.primary {
        background: var(--red);
        color: #fff;
        box-shadow: 0 10px 18px rgba(193, 18, 31, 0.18);
      }
      .btn.primary:hover {
        box-shadow: 0 14px 24px rgba(193, 18, 31, 0.22);
      }

      .btn.secondary {
        background: #fff;
        border-color: rgba(11, 61, 145, 0.25);
        color: var(--blue);
      }
      .btn.secondary:hover {
        background: rgba(11, 61, 145, 0.05);
      }

      .pill {
        display: inline-flex;
        gap: 10px;
        align-items: center;
        padding: 8px 12px;
        border-radius: 999px;
        background: rgba(11, 61, 145, 0.07);
        border: 1px solid rgba(11, 61, 145, 0.14);
        color: var(--blue);
        font-weight: 900;
        font-size: 14px;
        text-decoration: none;
        cursor: pointer;
      }

      /* Water Heater Specials badge = highlighted/urgent */
      .promo-badge {
        background: rgba(193, 18, 31, 0.12);
        border: 1px solid rgba(193, 18, 31, 0.28);
        color: var(--red);
        position: relative;
      }
      .promo-badge:hover {
        background: rgba(193, 18, 31, 0.16);
      }
      .promo-badge::after {
        content: "";
        position: absolute;
        inset: -2px;
        border-radius: 999px;
        box-shadow: 0 0 0 0 rgba(193, 18, 31, 0);
        pointer-events: none;
      }

      .muted {
        color: var(--muted);
        font-weight: 650;
      }

      /* Topbar */
      .topbar {
        position: sticky;
        top: 0;
        z-index: 50;
        background: rgba(255, 255, 255, 0.86);
        backdrop-filter: saturate(140%) blur(10px);
        border-bottom: 1px solid var(--line);
      }
      .topbar .row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 0;
        gap: 12px;
      }
      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
        min-width: 180px;
        text-decoration: none;
      }
      .brand img {
        height: 44px;
        width: auto;
        display: block;
      }
      .nav-actions {
        display: flex;
        align-items: center;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: flex-end;
      }

      /* Hero */
      .hero {
        position: relative;
        overflow: hidden;
        padding: 42px 0 18px;
      }
      .hero::before {
        content: "";
        position: absolute;
        inset: -120px -100px auto -100px;
        height: 320px;
        background: radial-gradient(
            1200px 260px at 20% 30%,
            rgba(11, 61, 145, 0.14),
            transparent 60%
          ),
          radial-gradient(
            900px 240px at 80% 20%,
            rgba(193, 18, 31, 0.14),
            transparent 60%
          ),
          linear-gradient(
            90deg,
            rgba(11, 61, 145, 0.06),
            rgba(193, 18, 31, 0.06)
          );
        transform: skewY(-6deg);
        border-bottom: 1px solid rgba(2, 8, 23, 0.06);
      }
      .hero-grid {
        position: relative;
        display: grid;
        grid-template-columns: 1.3fr 0.7fr;
        gap: 22px;
        align-items: stretch;
      }
      .hero-card {
        background: #fff;
        border: 1px solid rgba(2, 8, 23, 0.08);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 22px;
        height: 100%;
      }
      .hero-header {
        display: flex;
        gap: 16px;
        align-items: center;
      }
      .hero-header img {
        width: 210px;
        max-width: 45vw;
        height: auto;
        display: block;
      }
      h1 {
        margin: 0 0 10px;
        font-size: clamp(30px, 3.3vw, 44px);
        line-height: 1.08;
        letter-spacing: -0.6px;
      }
      .subhead {
        margin: 10px 0 16px;
        color: var(--muted);
        font-size: clamp(15px, 1.55vw, 18px);
      }
      .cta-row {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        align-items: center;
        margin-top: 10px;
      }
      .cta-note {
        margin: 10px 0 0;
        color: var(--muted);
        font-weight: 700;
        font-size: 13px;
      }
      .trust-strip {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin-top: 16px;
      }
      .trust {
        background: var(--card);
        border: 1px solid var(--line);
        border-radius: 14px;
        padding: 12px;
        font-weight: 800;
      }
      .trust small {
        display: block;
        font-weight: 700;
        color: var(--muted);
        margin-top: 2px;
      }
      .side-card {
        background: linear-gradient(
          180deg,
          rgba(11, 61, 145, 0.06),
          rgba(193, 18, 31, 0.06)
        );
        border: 1px solid rgba(2, 8, 23, 0.08);
        border-radius: var(--radius);
        padding: 18px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        gap: 14px;
      }
      .offer {
        background: #fff;
        border: 1px solid rgba(193, 18, 31, 0.18);
        border-radius: 16px;
        padding: 14px;
      }
      .offer .big {
        font-size: 34px;
        font-weight: 950;
        letter-spacing: -0.3px;
      }
      .ad-copy {
        font-size: 14px;
        opacity: 0.92;
        max-width: 54ch;
        margin: 0;
      }
      .offer .text {
        margin: 6px 0 0;
        font-weight: 900;
      }
      .offer .fine {
        margin: 8px 0 0;
        color: var(--muted);
        font-size: 13px;
        font-weight: 700;
      }

      section {
        padding: 28px 0;
      }
      .section-title {
        display: flex;
        align-items: flex-end;
        justify-content: space-between;
        gap: 12px;
        flex-wrap: wrap;
        margin-bottom: 12px;
      }
      h2 {
        margin: 0;
        font-size: clamp(22px, 2.1vw, 30px);
        letter-spacing: -0.4px;
      }
      .section-sub {
        margin: 0;
        color: var(--muted);
        font-weight: 650;
      }

      .grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 14px;
      }

      .card {
        background: #fff;
        border: 1px solid var(--line);
        border-radius: var(--radius);
        padding: 18px;
        box-shadow: 0 8px 20px rgba(2, 8, 23, 0.05);
      }

      .services {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 10px;
        margin-top: 12px;
      }
      .svc {
        border: 1px solid var(--line);
        background: var(--card);
        border-radius: 14px;
        padding: 12px;
        font-weight: 850;
      }
      .svc span {
        color: var(--blue);
      }

      .how {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 12px;
        margin-top: 12px;
      }
      .step {
        background: #fff;
        border: 1px solid var(--line);
        border-radius: var(--radius);
        padding: 16px;
      }
      .step .num {
        width: 34px;
        height: 34px;
        border-radius: 12px;
        display: grid;
        place-items: center;
        font-weight: 950;
        color: #fff;
        background: var(--blue);
        box-shadow: 0 10px 18px rgba(11, 61, 145, 0.18);
        margin-bottom: 10px;
      }
      .step:nth-child(2) .num {
        background: var(--red);
        box-shadow: 0 10px 18px rgba(193, 18, 31, 0.18);
      }
      .step h3 {
        margin: 0 0 6px;
        font-size: 17px;
        letter-spacing: -0.2px;
      }
      .step p {
        margin: 0;
        color: var(--muted);
        font-weight: 650;
      }

      .aside {
        border-radius: var(--radius);
        border: 1px solid var(--line);
        background: var(--card);
        padding: 16px;
      }

      footer {
        border-top: 1px solid var(--line);
        padding: 22px 0;
        color: var(--muted);
        font-weight: 650;
      }
      .footer-grid {
        display: grid;
        grid-template-columns: 1.2fr 0.8fr;
        gap: 14px;
        align-items: start;
      }
      .badges {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-top: 10px;
      }

      @media (max-width: 920px) {
        .hero-grid {
          grid-template-columns: 1fr;
        }
        .form {
          grid-template-columns: 1fr;
        }
        .aside {
          position: relative;
          top: auto;
        }
      }
      @media (max-width: 640px) {
        .trust-strip {
          grid-template-columns: 1fr;
        }
        .services {
          grid-template-columns: 1fr;
        }
        .how {
          grid-template-columns: 1fr;
        }
        .split {
          grid-template-columns: 1fr;
        }
        .topbar {
          position: relative; /* no sticky on mobile */
        }
      }
    </style>

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=AW-17942862558"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "AW-17942862558");
    </script>

    <!-- HouseCallPro Online Booking (load ONCE) -->
    <script
      async
      src="https://online-booking.housecallpro.com/script.js?token=56fe9001ad314433a6466f5d7d3131b9&orgName=Plumbazing"
    ></script>
  </head>

  <body>
    <!-- Top Bar -->
    <header class="topbar" aria-label="Top bar">
      <div class="container">
        <div class="row">
          <a class="brand" href="#top" aria-label="PlumbAZing home">
            <img src="PlumbAZing_logo.svg" alt="PlumbAZing logo" />
          </a>

          <nav class="nav-actions" aria-label="Quick actions">
            <!-- Urgent promo badge: jumps to Water Heater Specials slide -->
            <button
              class="pill promo-badge"
              type="button"
              id="waterHeaterBadge"
              aria-label="View water heater specials"
              title="Water Heater Specials"
            >
              ðŸ”¥ Water Heater Specials
            </button>

            <a class="btn secondary" href="#services">Services</a>
          </nav>
        </div>
      </div>
    </header>

    <!-- Hero -->
    <main id="top" class="hero">
      <div class="container">
        <div class="hero-grid">
          <!-- Left: Main hero copy -->
          <div class="hero-card">
            <div class="hero-header">
              <img src="PlumbAZing_logo.svg" alt="PlumbAZing logo" />
              <div>
                <h1>Honest, Reliable Plumbing Service in Austin</h1>
                <p class="subhead">
                  Residential repairs, installs, and drain help. Fast response,
                  clean work, no runaround.
                  <strong style="color: var(--blue)">Free estimates</strong>
                  for most jobs.
                </p>
              </div>
            </div>

            <div class="cta-row">
              <button
                class="btn primary"
                type="button"
                onclick="window.HCPWidget?.openModal?.()"
              >
                Request service
              </button>
              <a class="btn secondary" href="#services">View Services</a>
              <a class="btn secondary" href="tel:+15128884406">Call/Text</a>
            </div>

            <p class="cta-note">
              Tell us whatâ€™s going on and how urgent it is. Weâ€™ll reply ASAP
              with options + a quote.
            </p>

            <div class="trust-strip" aria-label="Trust signals">
              <div class="trust">
                Locally Owned
                <small>We treat your home like ours.</small>
              </div>
              <div class="trust">
                Free Estimates
                <small>For most common jobs.</small>
              </div>
              <div class="trust">
                Straightforward Service
                <small>Clear options. Clear pricing.</small>
              </div>
            </div>
          </div>

          <!-- Offer Banner -->
          <section aria-label="First time customer offer">
            <div class="container">
              <div class="banner">
                <div class="left">
                  <p class="headline">
                    New here? Get
                    <span style="color: var(--red)">$50 OFF</span>
                    your first service.
                  </p>
                  <p class="note">First-time customers â€¢ Expires: 12/31/26</p>
                </div>
                <div class="cta-row">
                  <button data-token="56fe9001ad314433a6466f5d7d3131b9" data-orgname="Plumbazing" class="hcp-button" onClick="HCPWidget.openModal()"> Book online </button> <script async src="https://online-booking.housecallpro.com/script.js?token=56fe9001ad314433a6466f5d7d3131b9&orgName=Plumbazing"> </script> <!--End of Housecallpro Online booking button-->
                  <a class="btn secondary" href="tel:+15128884406">Call Now</a>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </main>

    <!-- Services -->
    <section id="services">
      <div class="container">
        <div class="section-title">
          <div>
            <h2>Plumbing Services</h2>
            <p class="section-sub">
              If it leaks, clogs, or wonâ€™t behaveâ€¦ we handle it.
            </p>
          </div>
          <a class="btn secondary" href="sms:+15128884406">Text us a photo</a>
        </div>

        <div class="card">
          <div
            id="servicesGrid"
            class="services"
            aria-label="Services list"
          ></div>
          <p
            class="mini"
            style="margin: 12px 0 0; color: var(--muted); font-weight: 650"
          >
            Not sure what it is? Call or text and weâ€™ll point you in the right
            direction.
          </p>

          <div class="aside" aria-label="Need help fast">
            <div class="kicker">Need help now?</div>
            <p style="margin: 8px 0 0" class="mini">
              Call or text:
              <a
                href="tel:+15128884406"
                style="
                  color: var(--blue);
                  text-decoration: none;
                  font-weight: 900;
                "
              >
                (512) 888-4406
              </a>
            </p>
            <p style="margin: 10px 0 0" class="mini">
              Prefer online? Hit
              <strong>Request service</strong>
              and tell us whatâ€™s going on.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- How it Works + About -->
    <section id="about">
      <div class="container">
        <div class="grid-2">
          <div class="card">
            <div class="section-title" style="margin-bottom: 8px">
              <div>
                <h2>Getting Help is Easy</h2>
                <p class="section-sub">Simple steps. No mystery scheduling.</p>
              </div>
            </div>

            <div class="how">
              <div class="step">
                <div class="num">1</div>
                <h3>Reach out</h3>
                <p>Call, text, or request service.</p>
              </div>
              <div class="step">
                <div class="num">2</div>
                <h3>We respond ASAP</h3>
                <p>Weâ€™ll confirm details and send options + a quote.</p>
              </div>
              <div class="step">
                <div class="num">3</div>
                <h3>We schedule + fix it</h3>
                <p>Once approved, we lock in a time and get it handled.</p>
              </div>
            </div>
          </div>

          <div class="card" id="team">
            <div class="section-title" style="margin-bottom: 8px">
              <div>
                <h2>About PlumbAZing</h2>
                <p class="section-sub">
                  Local, reliable, and easy to work with.
                </p>
              </div>
            </div>

            <!-- Team photo (swap the src to your real file when ready) -->
            <img
              class="team-photo"
              src="img/ad-team.png"
              alt="The PlumbAZing team"
              loading="lazy"
            />

            <p style="margin: 0; color: var(--muted); font-weight: 650">
              PlumbAZing is a locally owned and operated plumbing company
              serving the Greater Austin area. Founded by experienced plumbers
              Josh and Alan, we spent years working for large plumbing companies
              before starting our own business.
              <br />
              <br />
              Our goal is simple: provide the same high level of service and
              professionalism youâ€™d expect from the big companies, without the
              inflated pricing and overhead. We specialize in residential and
              light commercial plumbing and take pride in honest work, clear
              communication, and reliable results.
            </p>

            <div class="badges" aria-label="Badges">
              <span class="pill">Locally Owned</span>
              <span class="pill">Free Estimates</span>
              <span class="pill">Call or Text</span>
              <span class="pill">
                <img width="50" src="lgbtqOwned.png" alt="LGBTQ Owned badge" />
              </span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="footer-grid">
          <div>
            <div class="kicker">PlumbAZing</div>
            <p style="margin: 8px 0 0">
              Honest, reliable residential plumbing in Austin, TX.
            </p>
          </div>
          <div>
            <div class="kicker">Business</div>
            <p style="margin: 8px 0 0" class="mini">
              Call/Text:
              <a
                href="tel:+15128884406"
                style="
                  color: var(--blue);
                  text-decoration: none;
                  font-weight: 900;
                "
              >
                (512) 888-4406
              </a>
              â€¢ Email:
              <span style="font-weight: 900; color: var(--ink)">
                service@plumbazing.com
              </span>
            </p>
            <p style="margin: 8px 0 0" class="mini">
              Biz ID:
              <strong>ML-44738</strong>
            </p>
          </div>
        </div>

        <p class="mini" style="margin: 14px 0 0">
          Â©
          <span id="y"></span>
          PlumbAZing. All rights reserved.
        </p>
      </div>
    </footer>

    <script>
      // Year
      document.getElementById("y").textContent = new Date().getFullYear();

      // Services list (easy to edit)
      const SERVICES = [
        "Leak repair",
        "Clogged drains",
        "Toilets & faucets",
        "Water heaters",
        "Garbage disposals",
        "Shower & tub valves",
        "Gas line work (where applicable)",
        "Sewer line diagnostics",
        "Fixture installs",
        "Emergency plumbing",
      ];

      const grid = document.getElementById("servicesGrid");
      if (grid)
        grid.innerHTML = SERVICES.map(
          (s) => `<div class="svc"><span>âœ“</span> ${s}</div>`
        ).join("");

      /*
        Per-slide options:
        - layout: "split" (text left + optional right image), or "stack" (optional top image), or "text"
        - actions: choose which buttons show; supports:
          { type: "request", label: "Request service" } -> opens HCP modal
          { type: "call", label: "Call/Text" } -> tel link
          { type: "scroll", label: "About PlumbAZing â†“", target: "#about" } -> smooth scroll
        - replyNote: optional supporting line
        - durationMs: optional per-slide auto-rotate duration override
      */

      const ADS = [
        {
          id: "request-help",
          layout: "split",
          badge: "Fast Response",
          kicker: "Tell us whatâ€™s going on",
          title: "Request help in under a minute",
          copy: "Share details + urgency. Weâ€™ll reply ASAP with options + a quote.",
          background:
            "linear-gradient(135deg, rgba(3,105,161,0.85), rgba(2,132,199,0.55))",
          actions: [
            { type: "request", label: "Request service" },
            { type: "call", label: "Call/Text" },
          ],
          replyNote: "Weâ€™ll reply ASAP with options + a quote.",
          // rightImage: "img/ad-request.png"
        },
        {
          id: "new-here",
          layout: "split",
          badge: "First-Time Offer",
          kicker: "New here?",
          title: "Get $50 OFF your first service",
          copy: "First-time customers. Request service or call/text and mention this offer.",
          background:
            "linear-gradient(135deg, rgba(193,18,31,0.75), rgba(11,61,145,0.55))",
          actions: [{ type: "request", label: "Request service" }],
          replyNote: "Weâ€™ll reply ASAP with options + a quote.",
          finePrint:
            "Expires: 12/31/26. Not valid with other offers. Ask for details.",
          // rightImage: "img/ad-new-here.png"
        },
        {
          id: "leak-repair",
          layout: "split",
          badge: "Common Fix",
          kicker: "Stop the drip, save the cabinet",
          title: "Leak detection + repair",
          copy: "Clear options, clean work, and straightforward communication.",
          background:
            "linear-gradient(135deg, rgba(30,41,59,0.75), rgba(14,116,144,0.55))",
          actions: [
            { type: "request", label: "Request service" },
            { type: "call", label: "Call/Text" },
          ],
          replyNote: "Weâ€™ll reply ASAP with options + a quote.",
          // rightImage: "img/ad-leak.png"
        },
        {
          id: "meet-the-team",
          layout: "stack",
          badge: "Meet the Team",
          kicker: "Local. Experienced. Easy to work with.",
          title: "Josh + Alan",
          copy: "Weâ€™re the folks who show up, explain the options, and leave your place cleaner than we found it.",
          background:
            "linear-gradient(135deg, rgba(11,61,145,0.70), rgba(15,23,42,0.75))",
          actions: [],
          textLink: { label: "About PlumbAZing â†“", target: "#about" },
          finePrint:
            "Want the quick version? Call or text and tell us whatâ€™s going on.",
          topImage: "img/ad-team.png",
        },
        {
          id: "water-heater-special",
          layout: "stack",
          badge: "Water Heater Specials",
          kicker: "Big water heater specials",
          title: "Save up to $500 + free estimates",
          copy: "10% OFF installs: up to $250 OFF tank water heaters and up to $500 OFF tankless. Price match guarantee available.",
          background:
            "linear-gradient(135deg, rgba(193,18,31,0.75), rgba(11,61,145,0.55))",
          actions: [{ type: "request", label: "Request service" }],
          replyNote: "Weâ€™ll reply ASAP with options + a quote.",
          finePrint:
            "Discount cap limited. Not valid with other offers/coupons/discounts. Price match must match equipment, installation, and warranty. Some limitations apply.",
          durationMs: 8500, // stay longer on this slide
          // rightImage: "img/ad-water-heater.png"
        },
      ];

      const DEFAULT_INTERVAL_MS = 6500;

      const track = document.getElementById("adTrack");
      const dotsWrap = document.getElementById("adDots");
      const prevBtn = document.getElementById("adPrev");
      const nextBtn = document.getElementById("adNext");
      const heroCarousel = document.getElementById("heroCarousel");

      let idx = 0;
      let timer = null;
      let pauseUntil = 0;

      function resolveBg(ad) {
        if (ad.imageUrl) {
          return `linear-gradient(180deg, rgba(0,0,0,0.28), rgba(0,0,0,0.72)), url('${ad.imageUrl}')`;
        }
        return (
          ad.background ||
          "linear-gradient(135deg, rgba(2,132,199,0.75), rgba(15,23,42,0.65))"
        );
      }

      function renderActions(ad, slideIndex) {
        const actions = Array.isArray(ad.actions) ? ad.actions : [];
        if (!actions.length) return "";

        return `
          <div class="ad-actions">
            ${actions
              .map((a) => {
                const label = a.label || "Request service";
                if (a.type === "request") {
                  return `<a class="ad-link" href="#" data-action="request" data-ad-cta="${slideIndex}">${label}</a>`;
                }
                if (a.type === "call") {
                  return `<a class="ad-link" href="tel:+15128884406" data-action="call">${label}</a>`;
                }
                if (a.type === "scroll" && a.target) {
                  return `<a class="ad-link" href="${a.target}" data-action="scroll" data-target="${a.target}">${label}</a>`;
                }
                if (a.type === "jump" && a.targetId) {
                  return `<a class="ad-link" href="#" data-action="jump" data-target-id="${a.targetId}">${label}</a>`;
                }
                if (a.type === "url" && a.href) {
                  return `<a class="ad-link" href="${a.href}" data-action="url">${label}</a>`;
                }
                return "";
              })
              .join("")}
          </div>
        `;
      }

      function renderSlide(ad, i) {
        const bg = resolveBg(ad);
        const layout = ad.layout || "split";

        const layoutClass =
          layout === "stack"
            ? "layout-stack"
            : layout === "text"
            ? "layout-text"
            : "layout-split";

        const hasRightMedia = layout === "split" && !!ad.rightImage;
        const hasTopMedia = layout === "stack" && !!ad.topImage;

        const topMediaHtml = hasTopMedia
          ? `<div class="ad-media-top" aria-hidden="true"><img src="${ad.topImage}" alt=""></div>`
          : "";

        const rightMediaHtml = hasRightMedia
          ? `<div class="ad-media" aria-hidden="true"><img src="${ad.rightImage}" alt=""></div>`
          : "";

        const textLinkHtml = ad.textLink?.target
          ? `<a class="ad-textlink" href="${
              ad.textLink.target
            }" data-action="scroll" data-target="${ad.textLink.target}">${
              ad.textLink.label || "About â†“"
            }</a>`
          : "";

        return `
          <article
            class="ad-slide ${layoutClass} ${i === idx ? "is-active" : ""}"
            role="group"
            aria-roledescription="slide"
            aria-label="${i + 1} of ${ADS.length}"
            data-ad-id="${ad.id || ""}"
            style="background-image:${bg};">

            ${topMediaHtml}

            <div class="ad-left">
              ${ad.badge ? `<span class="ad-badge">${ad.badge}</span>` : ""}
              ${ad.kicker ? `<div class="ad-kicker">${ad.kicker}</div>` : ""}
              ${ad.title ? `<h3 class="ad-title">${ad.title}</h3>` : ""}
              ${ad.copy ? `<p class="ad-copy">${ad.copy}</p>` : ""}

              ${renderActions(ad, i)}

              ${
                ad.replyNote
                  ? `<p class="ad-reply-note">${ad.replyNote}</p>`
                  : ""
              }
              ${textLinkHtml}
              ${ad.finePrint ? `<p class="ad-fine">${ad.finePrint}</p>` : ""}
            </div>

            ${rightMediaHtml}
          </article>
        `;
      }

      function renderCarousel() {
        if (!track || !dotsWrap) return;

        track.innerHTML = ADS.map((ad, i) => renderSlide(ad, i)).join("");

        dotsWrap.innerHTML = ADS.map(
          (_, i) =>
            `<button class="dot ${
              i === idx ? "active" : ""
            }" aria-label="Go to slide ${i + 1}" data-dot="${i}"></button>`
        ).join("");

        updateCarousel();
      }

      function updateCarousel() {
        if (!track || !dotsWrap) return;

        track.style.transform = `translateX(-${idx * 100}%)`;

        [...dotsWrap.children].forEach((d, i) =>
          d.classList.toggle("active", i === idx)
        );
        [...track.children].forEach((slide, i) =>
          slide.classList.toggle("is-active", i === idx)
        );
      }

      function getCurrentInterval() {
        const ad = ADS[idx] || {};
        return typeof ad.durationMs === "number"
          ? ad.durationMs
          : DEFAULT_INTERVAL_MS;
      }

      function restartAuto() {
        if (timer) clearTimeout(timer);

        const tick = () => {
          if (Date.now() < pauseUntil) {
            timer = setTimeout(tick, 450);
            return;
          }
          next(true);
        };

        timer = setTimeout(tick, getCurrentInterval());
      }

      function go(n, fromAuto = false) {
        idx = (n + ADS.length) % ADS.length;
        updateCarousel();

        // If user is interacting manually, reset cadence so it doesn't auto-swipe instantly.
        restartAuto();
      }

      function next(fromAuto = false) {
        go(idx + 1, fromAuto);
      }
      function prev() {
        go(idx - 1, false);
      }

      // Jump to slide by id
      window.goToAd = function (
        adId,
        opts = { scroll: true, highlight: false, pauseMs: 0 }
      ) {
        const targetIndex = ADS.findIndex((a) => a.id === adId);
        if (targetIndex === -1) return;

        go(targetIndex, false);

        if (opts.pauseMs) pauseUntil = Date.now() + opts.pauseMs;

        if (opts.scroll && heroCarousel?.scrollIntoView) {
          heroCarousel.scrollIntoView({ behavior: "smooth", block: "center" });
        }

        if (opts.highlight && heroCarousel) {
          heroCarousel.classList.remove("jump-highlight");
          void heroCarousel.offsetWidth;
          heroCarousel.classList.add("jump-highlight");
          setTimeout(
            () => heroCarousel.classList.remove("jump-highlight"),
            1100
          );
        }
      };

      // Dots click
      dotsWrap?.addEventListener("click", (e) => {
        const b = e.target.closest("button[data-dot]");
        if (!b) return;
        go(parseInt(b.dataset.dot, 10), false);
      });

      // Slide action clicks
      track?.addEventListener("click", (e) => {
        const el = e.target.closest("[data-action], a[data-ad-cta]");
        if (!el) return;

        const action = el.dataset.action;

        // Request service: open HouseCallPro modal
        if (action === "request" || el.hasAttribute("data-ad-cta")) {
          e.preventDefault();
          window.HCPWidget?.openModal?.();
          return;
        }

        // Scroll actions
        if (action === "scroll") {
          const target = el.dataset.target || el.getAttribute("href");
          if (target && target.startsWith("#")) {
            e.preventDefault();
            const node = document.querySelector(target);
            node?.scrollIntoView?.({ behavior: "smooth", block: "start" });
          }
          return;
        }

        // Jump to a slide
        if (action === "jump") {
          e.preventDefault();
          const targetId = el.dataset.targetId;
          if (targetId)
            window.goToAd(targetId, {
              scroll: false,
              highlight: true,
              pauseMs: 8000,
            });
          return;
        }
      });

      prevBtn?.addEventListener("click", prev);
      nextBtn?.addEventListener("click", () => next(false));

      // Swipe support
      let startX = 0,
        dx = 0;
      track?.addEventListener(
        "touchstart",
        (e) => {
          startX = e.touches[0].clientX;
          dx = 0;
        },
        { passive: true }
      );
      track?.addEventListener(
        "touchmove",
        (e) => {
          dx = e.touches[0].clientX - startX;
        },
        { passive: true }
      );
      track?.addEventListener("touchend", () => {
        if (Math.abs(dx) > 45) dx < 0 ? next(false) : prev();
        dx = 0;
      });

      // Pause auto-rotate on hover (desktop)
      heroCarousel?.addEventListener(
        "mouseenter",
        () => timer && clearTimeout(timer)
      );
      heroCarousel?.addEventListener("mouseleave", restartAuto);

      // Topbar badge -> jump to water heater slide with obvious feedback + pause
      document
        .getElementById("waterHeaterBadge")
        ?.addEventListener("click", () => {
          window.goToAd("water-heater-special", {
            scroll: true,
            highlight: true,
            pauseMs: 12000,
          });
        });

      // Init
      renderCarousel();
      restartAuto();
    </script>
  </body>
</html>
